"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }var _core = require('@orval/core');var _lodashomit = require('lodash.omit'); var _lodashomit2 = _interopRequireDefault(_lodashomit);var _lodashget = require('lodash.get'); var _lodashget2 = _interopRequireDefault(_lodashget);var w={bic:"faker.finance.bic()",city:"faker.address.city()",country:"faker.address.country()",date:"faker.date.past().toISOString().split('T')[0]","date-time":"`${faker.date.past().toISOString().split('.')[0]}Z`",email:"faker.internet.email()",firstName:"faker.name.firstName()",gender:"faker.name.gender()",iban:"faker.finance.iban()",ipv4:"faker.internet.ipv4()",ipv6:"faker.internet.ipv6()",jobTitle:"faker.name.jobTitle()",lastName:"faker.name.lastName()",password:"faker.internet.password()",phoneNumber:"faker.phone.phoneNumber()",streetName:"faker.address.streetName()",uri:"faker.internet.url()",url:"faker.internet.url()",userName:"faker.internet.userName()",uuid:"faker.datatype.uuid()",zipCode:"faker.address.zipCode()"};var _cuid = require('cuid'); var _cuid2 = _interopRequireDefault(_cuid);var E=({item:e,mockOptions:r,operationId:t,tags:s,combine:n,context:a,imports:p})=>{if(_core.isReference.call(void 0, e))return k({schema:{...e,name:e.name,path:e.path?`${e.path}.${e.name}`:e.name},mockOptions:r,operationId:t,tags:s,context:a,imports:p});if(e.allOf||e.oneOf||e.anyOf){let f=e.allOf?"allOf":e.oneOf?"oneOf":"anyOf";return A({item:e,separator:f,mockOptions:r,operationId:t,tags:s,combine:n,context:a,imports:p})}if(e.properties){let f=!n||(n==null?void 0:n.separator)==="oneOf"?"{":"",u=[],i=[];return f+=Object.entries(e.properties).map(([o,M])=>{if(n!=null&&n.includedProperties.includes(o))return;let c=(r==null?void 0:r.required)||(Array.isArray(e.required)?e.required:[]).includes(o);if(_core.count.call(void 0, e.path,`\\.${o}\\.`)>=1)return;let m=k({schema:{...M,name:o,path:e.path?`${e.path}.${o}`:`#.${o}`},mockOptions:r,operationId:t,tags:s,context:a,imports:u});u.push(...m.imports),i.push(o);let g=_core.getKey.call(void 0, o);return!c&&!m.overrided?`${g}: faker.helpers.arrayElement([${m.value}, undefined])`:`${g}: ${m.value}`}).filter(Boolean).join(", "),f+=!n||(n==null?void 0:n.separator)==="oneOf"?"}":"",{value:f,imports:u,name:e.name,includedProperties:i}}if(e.additionalProperties){if(_core.isBoolean.call(void 0, e.additionalProperties))return{value:"{}",imports:[],name:e.name};let f=k({schema:{...e.additionalProperties,name:e.name,path:e.path?`${e.path}.#`:"#"},mockOptions:r,operationId:t,tags:s,context:a,imports:p});return{...f,value:`{
        '${_cuid2.default.call(void 0, )}': ${f.value}
      }`}}return{value:"{}",imports:[],name:e.name}};var x=({item:e,imports:r,mockOptions:t,operationId:s,tags:n,combine:a,context:p})=>{var c,m,g,$;let f=R((m=(c=t==null?void 0:t.operations)==null?void 0:c[s])==null?void 0:m.properties,e);if(f)return f;let u=Object.entries((g=t==null?void 0:t.tags)!=null?g:{}).reduce((l,[O,h])=>n.includes(O)?_core.mergeDeep.call(void 0, l,h):l,{}),i=R(u==null?void 0:u.properties,e);if(i)return i;let o=R(t==null?void 0:t.properties,e);if(o)return o;let M={...w,...($=t==null?void 0:t.format)!=null?$:{}};if(e.format&&M[e.format])return{value:j(M[e.format],e.nullable),imports:[],name:e.name,overrided:!1};switch(e.type){case"number":case"integer":return{value:j(`faker.datatype.number({min: ${e.minimum}, max: ${e.maximum}})`,e.nullable),imports:[],name:e.name};case"boolean":return{value:"faker.datatype.boolean()",imports:[],name:e.name};case"array":{if(!e.items)return{value:"[]",imports:[],name:e.name};let{value:l,enums:O,imports:h,name:b}=k({schema:{...e.items,name:e.name,path:e.path?`${e.path}.[]`:"#.[]"},combine:a,mockOptions:t,operationId:s,tags:n,context:p,imports:r});if(O){if(!_core.isReference.call(void 0, e.items))return{value:l,imports:h,name:e.name};let S=r.find(P=>b.replace("[]","")===P.name);return{value:`faker.helpers.arrayElements(Object.values(${(S==null?void 0:S.name)||b}))`,imports:S?[...h,{...S,values:!0,..._core.isRootKey.call(void 0, p.specKey,p.target)?{}:{specKey:p.specKey}}]:h,name:e.name}}let d=l;return a&&(!l.startsWith("faker")||!l.startsWith("{"))&&(d=`{${l}}`),{value:`Array.from({ length: faker.datatype.number({ min: ${t==null?void 0:t.arrayMin}, max: ${t==null?void 0:t.arrayMax} }) }, (_, i) => i + 1).map(() => (${d}))`,imports:h,name:e.name}}case"string":{let l="faker.random.word()",O=[];if(e.enum){let h="['"+e.enum.map(b=>_core.escape.call(void 0, b)).join("','")+"']";e.isRef&&(h=`Object.values(${e.name})`,O=[{name:e.name,values:!0,..._core.isRootKey.call(void 0, p.specKey,p.target)?{}:{specKey:p.specKey}}]),l=`faker.helpers.arrayElement(${h})`}return{value:j(l,e.nullable),enums:e.enum,name:e.name,imports:O}}case"object":default:return E({item:e,mockOptions:t,operationId:s,tags:n,combine:a,context:p,imports:r})}};var ee=e=>e[0]==="/"&&e[e.length-1]==="/",R=(e={},r)=>{let t=Object.entries(e).find(([s])=>!!(ee(s)&&new RegExp(s.slice(1,s.length-1)).test(r.name)||`#.${s}`===(r.path?r.path:`#.${r.name}`)));if(!!t)return{value:j(t[1],r.nullable),imports:[],name:r.name,overrided:!0}},j=(e,r)=>r?`faker.helpers.arrayElement([${e}, null])`:e,k=({schema:e,mockOptions:r,operationId:t,tags:s,combine:n,context:a,imports:p})=>{if(_core.isReference.call(void 0, e)){let{name:u,specKey:i=a.specKey,refPaths:o}=_core.getRefInfo.call(void 0, e.$ref,a),c={..._lodashget2.default.call(void 0, a.specs[i],o),name:u,path:e.path,isRef:!0};return{...x({item:c,mockOptions:r,operationId:t,tags:s,combine:n,context:{...a,specKey:i},imports:p}),type:c.type}}return{...x({item:e,mockOptions:r,operationId:t,tags:s,combine:n,context:a,imports:p}),type:e.type}};var A=({item:e,separator:r,mockOptions:t,operationId:s,tags:n,combine:a,context:p,imports:f})=>{var c,m,g,$;let u=[],i=((c=a==null?void 0:a.includedProperties)!=null?c:[]).slice(0),o=_core.isReference.call(void 0, e)||e.properties?k({schema:_lodashomit2.default.call(void 0, e,r),combine:{separator:"allOf",includedProperties:[]},mockOptions:t,operationId:s,tags:n,context:p,imports:f}):void 0;return i.push(...(m=o==null?void 0:o.includedProperties)!=null?m:[]),u.push(...(g=o==null?void 0:o.imports)!=null?g:[]),{value:(($=e[r])!=null?$:[]).reduce((l,O,h,b)=>{var I,N;let d=k({schema:{...O,name:e.name,path:e.path?e.path:"#"},combine:{separator:r,includedProperties:r!=="oneOf"?i:(I=o==null?void 0:o.includedProperties)!=null?I:[]},mockOptions:t,operationId:s,tags:n,context:p,imports:f});u.push(...d.imports),i.push(...(N=d.includedProperties)!=null?N:[]);let S=h===b.length-1,y=d.value;(o==null?void 0:o.value)&&r==="oneOf"&&(y=`${d.value.slice(0,-1)},${o.value}}`),(o==null?void 0:o.value)&&r!=="oneOf"&&S&&(y=`${y}${o!=null&&o.value?`,${o.value}`:""}`);let P=!a||a.separator==="oneOf"&&r==="allOf";return!h&&P?d.enums||r==="oneOf"||d.type==="array"?b.length===1?`faker.helpers.arrayElement([${y}])`:`faker.helpers.arrayElement([${y},`:b.length===1?d.type&&d.type!=="object"?y:`{${y}}`:`{${y},`:S?d.enums||r==="oneOf"||d.type==="array"?`${l}${y}${a?"":"])"}`:`${l}${y}${P?"}":""}`:y?`${l}${y},`:l},""),imports:u,name:e.name,includedProperties:i}};var K=e=>/[^{]*{[\w*_-]*}.*/.test(e),_=e=>{let r=e.match(/([^{]*){?([\w*_-]*)}?(.*)/);if(!(r!=null&&r.length))return e;let t=r[1],s=_core.sanitize.call(void 0, _core.camel.call(void 0, r[2]),{es5keyword:!0,underscore:!0,dash:!0,dot:!0}),n=K(r[3])?_(r[3]):r[3];return K(e)?`${t}:${s}${n}`:`${t}${s}${n}`},T=(e,r="*")=>e.split("/").reduce((s,n,a)=>!n&&!a?s:n.includes("{")?`${s}/${_(n)}`:`${s}/${n}`,r);var G=(e,r)=>Object.entries(_core.isFunction.call(void 0, e)?e(r):e).reduce((t,[s,n])=>{let a=_core.isFunction.call(void 0, n)?`(${n})()`:_core.stringify.call(void 0, n);return t[s]=a==null?void 0:a.replace(/import_faker.defaults|import_faker.faker/g,"faker"),t},{}),pe=(e,r)=>{var t,s,n,a,p;return{arrayMin:(t=r==null?void 0:r.mock)==null?void 0:t.arrayMin,arrayMax:(s=r==null?void 0:r.mock)==null?void 0:s.arrayMax,required:(n=r==null?void 0:r.mock)==null?void 0:n.required,...(a=r==null?void 0:r.mock)!=null&&a.properties?{properties:G(r.mock.properties,e)}:{},...(p=r==null?void 0:r.mock)!=null&&p.format?{format:G(r.mock.format,e)}:{},...r!=null&&r.operations?{operations:Object.entries(r.operations).reduce((f,[u,i])=>{var o;return(o=i.mock)!=null&&o.properties&&(f[u]={properties:G(i.mock.properties,e)}),f},{})}:{},...r!=null&&r.tags?{tags:Object.entries(r.tags).reduce((f,[u,i])=>{var o;return(o=i.mock)!=null&&o.properties&&(f[u]={properties:G(i.mock.properties,e)}),f},{})}:{}}},fe=(e,r)=>{let t=e.endsWith("[]");switch(t?e.slice(0,-2):e){case"number":return t?`Array.from({length: faker.datatype.number({min: ${r.arrayMin}, max: ${r.arrayMax}})}, () => faker.datatype.number())`:"faker.datatype.number().toString()";case"string":return t?`Array.from({length: faker.datatype.number({min: ${r==null?void 0:r.arrayMin},max: ${r==null?void 0:r.arrayMax}})}, () => faker.random.word())`:"faker.random.word()";default:return"undefined"}},ue=({operationId:e,tags:r,response:t,mockOptionsWithoutFunc:s,transformer:n,context:a})=>t.types.success.reduce((p,{value:f,originalSchema:u,imports:i,isRef:o})=>{var m,g;if(!f||_core.generalJSTypesWithArray.includes(f)){let $=fe(f,s);return p.definitions.push(n?n($,t.definition.success):$),p}if(!u)return p;let M=_core.resolveRef.call(void 0, u,a),c=x({item:{name:f,...M.schema},imports:i,mockOptions:s,operationId:e,tags:r,context:o?{...a,specKey:(g=(m=t.imports[0])==null?void 0:m.specKey)!=null?g:a.specKey}:a});return p.imports.push(...c.imports),p.definitions.push(n?n(c.value,t.definition.success):c.value.toString()),p},{definitions:[],imports:[]}),z=({operationId:e,tags:r,response:t,override:s,transformer:n,context:a})=>{let p=pe(a.specs[a.specKey],s),{definitions:f,imports:u}=ue({operationId:e,tags:r,response:t,mockOptionsWithoutFunc:p,transformer:n,context:a});return{definition:"["+f.join(", ")+"]",definitions:f,imports:u}},L=(e,r)=>{var n,a,p;let t=(p=(a=(n=r==null?void 0:r.operations)==null?void 0:n[e])==null?void 0:a.mock)==null?void 0:p.data,s=_core.isFunction.call(void 0, t)?`(${t})()`:_core.stringify.call(void 0, t);return s==null?void 0:s.replace(/import_faker.defaults|import_faker.faker/g,"faker")};var ce=[{exports:[{name:"rest",values:!0}],dependency:"msw"},{exports:[{name:"faker",values:!0}],dependency:"@faker-js/faker"}],mr= exports.generateMSWImports =({implementation:e,imports:r,specsName:t,hasSchemaDir:s,isAllowSyntheticDefaultImports:n})=>_core.generateDependencyImports.call(void 0, e,[...ce,...r],t,s,n),gr= exports.generateMSW =({operationId:e,response:r,verb:t,tags:s},{pathRoute:n,override:a,context:p})=>{var g,$,l;let{definitions:f,definition:u,imports:i}=z({operationId:e,tags:s,response:r,override:a,context:p}),o=T(n,(g=a==null?void 0:a.mock)==null?void 0:g.baseUrl),M=L(e,a),c="";M?c=M:f.length>1?c=`faker.helpers.arrayElement(${u})`:f[0]&&(c=f[0]);let m=r.contentTypes.includes("text/plain")?"text":"json";return{implementation:{function:c&&c!=="undefined"?`export const get${_core.pascal.call(void 0, e)}Mock = () => (${c})

`:"",handler:`rest.${t}('${o}', (_req, res, ctx) => {
        return res(
          ctx.delay(${(l=($=a==null?void 0:a.mock)==null?void 0:$.delay)!=null?l:1e3}),
          ctx.status(200, 'Mocked status'),${c&&c!=="undefined"?`
ctx.${m}(get${_core.pascal.call(void 0, e)}Mock()),`:""}
        )
      }),`},imports:i}};exports.generateMSW = gr; exports.generateMSWImports = mr;
